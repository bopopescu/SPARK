how long is the data transfer between stages

>> try it 
tc will tell the OS instead
tc ... 

How do they set the network connection
newConnection(socket.getIp());


normal : 88, 87, 89 

10 Mbps, the workload runs for X seconds, and SE was [triggered or not triggered?] 93, 88, 86, 86, 90

1 Mbps, the workload runs for X seconds, and SE was [triggered or not triggered?] 93, 87, 86, 87, 89

0.1 Mbps, the workload runs for X seconds, and SE was [triggered or not triggered?] 90, 87, 89

0.01 Mbps, the workload runs for X seconds, and SE was [triggered or not triggered?] 92, 88, 86


today

[10.28.34] haryadi.gunawi: time cp /tmp/largefile /proj/...
[10.28.50] haryadi.gunawi: time cp /proj/... /tmp/largfile


Topology!!!!
hadoop speculative execution
https://people.eecs.berkeley.edu/~adj/publications/paper-files/osdi_late.pdf section 2.1

http://ucare.cs.uchicago.edu/pdf/socc13-limplock.pdf section 5.1
section 3 and 4

struggler -> someone slower than the rest



Stage3:

TaskC --- TaskE  -- write the entire data to HDFS file?
TaskD --- TaskE 


4 stages: A-read, B-sort1, C-sort2, D-write (CONFIRMED)
2 partitions

Every stage there are two tasks (CONFIRMED)

A1-B1 ??
A2-B2 ??
Does A1 send something B2?? Is this 1-on-1 communication? Or all-to-all communication?
TODO: Confirm / understand the dataflow

B1-C1
B1-C2
B2-C1      (w3 slow, so data transfer to C1 is slow)
B2-C2      (w3 slow, so data transfer to C2 is slow)
                 FLAW of current SE (it’s based on task progress score, the base SE does NOT expose
                  The individual path bandwidths)
                 The fact that C2 reads from B1 AND B2   …. But C2 only reports one progress score

Driver ← (low progress score + B1-C1 + B2-C1) C1 ← B1 (1000 Mbps) .. B2 (1 Mbps)
Driver ← (low progress score) C2 

-------------------
For (......) {
   Start = gettimeofday()
    Byte = readInput(byteBuffer[64KB]);  // C1 runs to get data from B1/B2       // network packet, (64 KB, HDFS)
   End = gettimeofday();
   Bw  = byte/(end-start);
}
----------------- 1 hour

B1-C1:   999 Mbps, 998 Mbps,  865 Mbps, 
B2-C1:       5 Mbps,     1 Mbps,     4 Mbps
B1-C2:   999 Mbps, 998 Mbps,  865 Mbps, 
B2-C2:       5 Mbps,     1 Mbps,     4 Mbps


Progress score is important!!
print the current time and the progress
	how the progress score is increasing in each of the task 
	progress score for each task (B1, B2)
https://web.skype.com/xmmfallback?pic=0-eus-d5-30cae4631b0a1627c35c2299e47e605b

Task
- delay W2
- monitor every task


Daniar (september-1)

Delay W2  (A2 → B2 transfer? Local file ;;;  NFS → A2 → B2)

Delay 100, 10, and 1 Mbps

In each scenario, report your observation about the progress score of EACH TASK.
(who is fast, who is slow?)
A1/A2/B1/B2/..: slow/fast (time to completion)

In each scenario, check if SE is run or not


- run task in one node and compare with W2 and W1
- modify heartbeat 2 s
- progress score
- understand the communication pattern
     Do this: 
     W1: T1, T3,    W3: T5, T7
     W2: T2, T4,    W4: T6, T8


-CREATE 


-------------------
     A while back:
     W1: T1, T3,    W3: T5, T7
     W2: T2, T4,    W4: T6, T8
     But now (bad)
     W1: T1     W3: T3
     W2: T2     W4: T4

--------------
Todo-0: heartbeat changes to 2 seconds

Todo-1a: two separate jobs, one node, verify tc is correct:    localFile → Task.  Fast/SLow?
Todo-1b: Two task of the same stage in one limping node.   localFile → T1 → T2 (all in the same limping node). Fast/Slow?
  
Todo-3: a complete sort (yes, put back, save as TextFile, 4 stages)


     Do this: 
     W1: T1, T3,    W3: T5, T7
     W2: T2, T4,    W4: T6, T8
     1 Mbps, job latency?
     Does SE run? (same report style)

Todo-4: Understand the communication pattern … 
     (Also measure integer count !)  .. or whatever other method

Todo-5: 
Try create a SIMPLEST topology that will give me 4 tasks total in 4 workers:
T1-T3 
T1-T4
T2-T3
T2-T4
(you need to create the input data??? .. but make sure that it will lead to all to all)
https://databricks.gitbooks.io/databricks-spark-knowledge-base/content/best_practices/prefer_reducebykey_over_groupbykey.html



W2 … (manual finding where W2 is)  MUST BE in 2a

[M1234]--blue

M 1 2b 2b 3 4 (ns topology)
    [M 1 2b 3 4] -- blue  
    2a -- 2b  (connected directly via a link)

    Your spark ONLY knows 5 nodes
     [M 1 2a 3 4]
     tc on 2b  (it’s okay to delay the local lo)

Do network test, tc-2b … 
    1-3 is fine
    2a-3 is not fine


where is the buffer
set timing before and after

follow the rdd
inside rdd is buffer